import{r as t,d as s,h as e,H as o,g as i}from"./p-8a8b139b.js";import{S as r}from"./p-85cd1ecc.js";import{L as h}from"./p-37fda961.js";import{K as a,a as n,N as c}from"./p-617961cc.js";import{R as l}from"./p-573c7aa9.js";const b=class{constructor(e){t(this,e),this.focused=!1,this.expanded=!1,this.autoComplete=!1,this.ariaLabelledby=r.empty(),this.ariaLabel=r.empty(),this.languageJson=r.empty(),this.languageString=r.empty(),this.searchFunctionRef=r.empty(),this.value="",this.activeIndex=-1,this.sntInput=s(this,"sntInput",7),this.sntFocus=s(this,"sntFocus",7),this.sntBlur=s(this,"sntBlur",7)}activeIndexChange(t){this.autoComplete&&-1!=t&&(this.value=this.SearchSuggestion[this.activeIndex].title)}componentWillLoad(){if(r.isEmpty(this.hostElement.id))throw new Error(b.TAG_NAME+" must have a valid id.");if(!this.searchFunctionRef)throw new Error(b.TAG_NAME+" requires a valid reference to a search function.");l.getObjectReference(this.searchFunctionRef).then(t=>{this.searchFunction=t}),this.languageVariables=h.getVariablesFromString(this.languageString,["search"]),this.initKeyboardEventProcessor()}onClick(t){t.target===this.input||this.hostElement.contains(t.target)||(this.focused=this.expanded=!1)}async setFocus(){return this.input&&this.input.focus(),Promise.resolve()}async getInputElement(){return Promise.resolve(this.input)}onFocus(){this.focused=!0,this.sntFocus.emit(),this.updateSearchSuggestions()}onInput(t){const s=t.target;s&&(this.value=s.value),this.updateSearchSuggestions(),this.sntInput.emit(t)}onListboxClick(t){t.target&&"LI"==t.target.nodeName&&(this.activeIndex=t.target.dataset.index,this.selectItem())}selectItem(){-1!==this.activeIndex&&(this.value=this.SearchSuggestion[this.activeIndex].title,this.expanded=!1)}clear(){this.expanded=!1,this.value=r.empty()}dismiss(){this.focused=this.expanded=!1}updateSearchSuggestions(){this.SearchSuggestion=this.searchFunction(this.input.value),this.expanded=this.SearchSuggestion.length>0}initKeyboardEventProcessor(){this.keyboardEventProcessor=a.newInstance().withKey(n.ARROW_UP,()=>this.setNextActiveIndex(c.BACKWARDS)).withKey(n.ARROW_DOWN,()=>this.setNextActiveIndex(c.FORWARDS)).withKey(n.HOME,()=>this.setNextActiveIndex(c.FIRST)).withKey(n.END,()=>this.setNextActiveIndex(c.LAST)).withKey(n.ENTER,()=>this.selectItem()).withKey(n.ESCAPE,()=>this.clear()).withKey(n.TAB,()=>this.dismiss()).build()}processKeyboardEvent(t){this.keyboardEventProcessor.process(t)}setNextActiveIndex(t){t==c.BACKWARDS?this.activeIndex=this.activeIndex<=0?this.SearchSuggestion.length-1:this.activeIndex-1:t==c.FORWARDS?this.activeIndex=this.activeIndex>=this.SearchSuggestion.length-1?0:this.activeIndex+1:t==c.FIRST?this.activeIndex=0:t==c.LAST&&(this.activeIndex=this.SearchSuggestion.length-1)}highlightPattern(t,s){const o=t.split(s);if(o.length<=1)return t;const i=t.match(s);return o.reduce((t,s,o)=>i[o]?[...t,s,e("b",null,i[o])]:[...t,s],[])}render(){const t=this.hostElement.id?this.hostElement.id+"-combobox":null,s=this.hostElement.id?this.hostElement.id+"-textbox":null,i=this.hostElement.id?this.hostElement.id+"-listbox":null;return e(o,{class:{"search-combobox-has-focus":this.focused,"search-combobox-is-expanded":this.expanded}},r.notEmpty(this.ariaLabel)?e("label",{htmlFor:s,class:"sr-only"},this.ariaLabel):null,e("div",{role:"combobox",id:t,"aria-haspopup":"listbox","aria-owns":i,"aria-expanded":this.expanded.toString(),class:"search-input-area"},e("snt-icon",{styleClasses:"iconNavSearch"}),e("input",{type:"text",id:s,role:"textbox","aria-labelledby":this.ariaLabelledby||null,"aria-autocomplete":"both","aria-controls":i,"aria-activedescendant":this.activeIndex>=0?"result-item-"+this.activeIndex:null,onInput:this.onInput.bind(this),onFocus:this.onFocus.bind(this),onKeyDown:this.processKeyboardEvent.bind(this),placeholder:this.languageVariables.get("search"),ref:t=>this.input=t,value:this.value})),e("ul",{id:i,role:"listbox",class:"search-results-area",onClick:this.onListboxClick.bind(this)},this.focused&&this.SearchSuggestion.length>0?this.SearchSuggestion.map((t,s)=>e("li",{role:"option","aria-selected":s==this.activeIndex,id:"result-item-"+s,class:{result:!0,"result-is-focused":s==this.activeIndex},"data-index":s},this.highlightPattern(t.title,new RegExp(this.input.value,"ig")))):null),this.focused?e("snt-backdrop",null):null)}get hostElement(){return i(this)}static get watchers(){return{activeIndex:["activeIndexChange"]}}};b.TAG_NAME="snt-search-combobox",b.style='snt-search-combobox{display:block;position:relative;background-color:#ffffff;width:100%}snt-search-combobox input{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:2.525rem;font-size:0.875rem;line-height:1.25rem}snt-search-combobox snt-button button{display:none;position:absolute;right:0.5rem;top:0;bottom:0;margin:auto;font-size:1.125rem;line-height:1.125rem;color:#323232}snt-search-combobox.theme-default{background-color:transparent}snt-search-combobox.theme-default :focus{outline:none}snt-search-combobox.theme-default snt-button{display:none}snt-search-combobox.theme-default snt-icon{margin:0 0.625rem 0 1.25rem}snt-search-combobox.theme-default input{border:none;border-radius:0;background-color:transparent}snt-search-combobox.theme-default ul{list-style:none;margin:0;padding:0}snt-search-combobox.theme-default .search-input-area{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;background-color:#ffffff;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid #b2b2b2;border-radius:25px}snt-search-combobox.theme-default .search-input-area:hover{border-color:#147582}snt-search-combobox.theme-default .search-results-area{display:none;color:#323232;position:absolute;left:0;right:0;top:100%;width:100%;padding:0.625rem;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:left;border:1px solid transparent;border-top:none;border-bottom-left-radius:25px;border-bottom-right-radius:25px;background-color:white}snt-search-combobox.theme-default .search-results-area:before{position:absolute;content:" ";height:1px;margin-right:auto;margin-left:auto;top:0;left:0;right:0;width:calc(100% - 2rem);background-color:#147582}snt-search-combobox.theme-default .result{padding:0.3125rem 0.625rem;font-size:14px;line-height:23px;border-bottom:1px solid #e5e5e5}snt-search-combobox.theme-default .result:last-child{border-bottom:none}snt-search-combobox.theme-default.search-combobox-has-focus snt-backdrop{display:block;background-color:rgba(50, 50, 50, 0.2)}snt-search-combobox.theme-default.search-combobox-is-expanded .search-input-area{border:1px solid transparent;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:none;pointer-events:all}snt-search-combobox.theme-default.search-combobox-is-expanded .search-results-area{display:block}snt-search-combobox.theme-default .result{cursor:default}snt-search-combobox.theme-default .result:hover,snt-search-combobox.theme-default .result.result-is-focused{background-color:#f8f8f8}snt-search-combobox.theme-default .result b{pointer-events:none}';export{b as snt_search_combobox}