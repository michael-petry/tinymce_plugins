var __awaiter=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{u(r.next(e))}catch(t){o(t)}}function a(e){try{u(r["throw"](e))}catch(t){o(t)}}function u(e){e.done?n(e.value):i(e.value).then(s,a)}u((r=r.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(e){return function(t){return u([e,t])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=t.call(e,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};System.register(["./p-64b22a95.system.js","./p-1bc037df.system.js","./p-956e5db9.system.js","./p-f47dc977.system.js"],(function(e){"use strict";var t,n,r,i,o,s,a,u,l;return{setters:[function(e){t=e.r;n=e.d;r=e.h;i=e.H;o=e.g},function(){},function(e){s=e.W},function(e){a=e.K;u=e.a;l=e.N}],execute:function(){var c=function(){function e(e){this.label=e.label;this.key=e.key,this.url=e.url,this.id=e.id;this.languageId=e.languageId;this.parentId=e.parentId;this.expandable=e.expandable||false;this.visible=e.visible||false;this.selected=e.selected||false;this.expanded=e.expanded||false;this.domElement=e.domElement||null}return e}();var d="snt-treeview{display:block}snt-treeview ul{list-style:none;padding:0}snt-treeview li,snt-treeview a{color:#323232;font-size:1rem;line-height:1.3125rem}snt-treeview li:focus,snt-treeview a:focus{outline:none}snt-treeview li{margin-bottom:1.25rem}snt-treeview li:last-child{margin-bottom:0}snt-treeview li.active>span{border-bottom:3px solid #147582;color:#147582}snt-treeview li>ul{padding:1rem 0 0.625rem 1.875rem}snt-treeview li>ul li{margin-bottom:1rem}snt-treeview li>ul li:last-child{margin-bottom:0}snt-treeview li:focus>span,snt-treeview li.focused>span{font-weight:bold;color:#147582}snt-treeview li>span{pointer-events:none}snt-treeview a:focus,snt-treeview a.focused{font-weight:bold;color:#147582}snt-treeview a.active{border-bottom:2px solid #147582;color:#147582}snt-treeview [role=treeitem][aria-expanded=false]>ul{display:none}";var f=e("snt_treeview",function(){function e(e){t(this,e);this.sntChange=n(this,"sntChange",7)}e.prototype.componentWillLoad=function(){var e=s.getObjectFromString(this.structure);this.treeitems=this.getItemsFromTree(e,this.treeitems=[]);this.keyboardEventProcessor=this.initKeyboardEventProcessor()};e.prototype.componentDidLoad=function(){var e=this.treeitems.find((function(e){return e.selected}));if(!e){this.treeitems[0].domElement.setAttribute("tabindex","0")}};e.prototype.componentWillUpdate=function(){};e.prototype.componentDidUpdate=function(){var e=this.treeitems.find((function(e){return e.selected}));if(e){e.domElement.focus()}};e.prototype.getTreeitems=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,Promise.resolve(this.treeitems)]}))}))};e.prototype.updateExpandedTreeitems=function(e,t,n){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,Promise.resolve(e.map((function(e){return t.indexOf(e)!=-1?new c(Object.assign(Object.assign({},e),{expanded:typeof n=="boolean"?n:!e.expanded})):e})))]}))}))};e.prototype.updateVisibleTreeitems=function(e,t,n){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,Promise.resolve(e.map((function(e){return t.indexOf(e)!=-1?new c(Object.assign(Object.assign({},e),{visible:typeof n=="boolean"?n:!e.visible})):e})))]}))}))};e.prototype.updateSelectedTreeitems=function(e,t,n){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,Promise.resolve(e.map((function(e){return t.indexOf(e)!=-1?new c(Object.assign(Object.assign({},e),{selected:typeof n=="boolean"?n:!e.selected})):e.selected?new c(Object.assign(Object.assign({},e),{selected:false})):e})))]}))}))};e.prototype.findNodeByProperty=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return[2,this.treeitems.find((function(n){return n[e]==t}))]}))}))};e.prototype.selectNodeByUrl=function(e){return __awaiter(this,void 0,void 0,(function(){var t,n,r,i;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.findNodeByProperty("url",e)];case 1:t=o.sent();n=this.treeitems.find((function(e){return e.parentId==t.id}));if(!n)return[3,3];r=this;return[4,this.updateExpandedTreeitems(this.treeitems,[t],true)];case 2:r.treeitems=o.sent();o.label=3;case 3:i=this;return[4,this.updateSelectedTreeitems(this.treeitems,[n?n:t],true)];case 4:i.treeitems=o.sent();this.sntChange.emit({node:n?n:t,parentNode:n?t:null,originalEvent:null});return[2]}}))}))};e.prototype.initKeyboardEventProcessor=function(){var e=this;return a.newInstance().withKey(u.ARROW_UP,(function(t){e.moveSelection(t,l.BACKWARDS)})).withKey(u.ARROW_DOWN,(function(t){e.moveSelection(t,l.FORWARDS)})).withKey(u.ARROW_RIGHT,(function(t){var n=e.treeitems.find((function(e){return e.domElement==t.target}));if(n&&n.expandable){if(n.expanded){e.moveSelection(t,l.FORWARDS);return}e.toggleTreeitem(n)}})).withKey(u.ARROW_LEFT,(function(t){return __awaiter(e,void 0,void 0,(function(){var e,n,r;return __generator(this,(function(i){switch(i.label){case 0:e=this.treeitems.find((function(e){return e.domElement==t.target}));if(e&&e.expandable&&e.expanded){this.toggleTreeitem(e);return[2]}if(!e.parentId)return[3,2];n=this.treeitems.find((function(t){return t.id==e.parentId}));r=this;return[4,this.updateSelectedTreeitems(this.treeitems,[n])];case 1:r.treeitems=i.sent();i.label=2;case 2:return[2]}}))}))})).withKey(u.HOME,(function(t){e.moveSelection(t,l.FIRST)})).withKey(u.END,(function(t){e.moveSelection(t,l.LAST)})).withKey(u.ASTERISK,(function(t){var n=e.treeitems.find((function(e){return e.domElement==t.target}));var r=e.treeitems.filter((function(e){return e.expandable&&e.parentId==n.parentId}));r.forEach((function(t){e.toggleTreeitem(t,true)}))})).withKeys([u.ENTER,u.SPACE],(function(t){t.preventDefault();var n=e.treeitems.find((function(e){return e.domElement==t.target}));if(!n)return;if(n.expandable){t.preventDefault();e.toggleTreeitem(n)}else{var r=e.treeitems.find((function(e){return e.id==n.parentId}));e.sntChange.emit({node:n,parentNode:r||null,originalEvent:t})}})).withDefaultHandler((function(t){return __awaiter(e,void 0,void 0,(function(){var e,n;return __generator(this,(function(r){switch(r.label){case 0:e=this.getNextSelectableNodeByFirstCharacter(this.treeitems,t.key);if(!e)return[3,2];n=this;return[4,this.updateSelectedTreeitems(this.treeitems,[e])];case 1:n.treeitems=r.sent();r.label=2;case 2:return[2]}}))}))})).build()};e.prototype.moveSelection=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n,r;return __generator(this,(function(i){switch(i.label){case 0:e.preventDefault();n=this.getNextSelectableNode(this.treeitems,t);if(!n)return[3,2];r=this;return[4,this.updateSelectedTreeitems(this.treeitems,[n])];case 1:r.treeitems=i.sent();i.label=2;case 2:return[2]}}))}))};e.prototype.getNextSelectableNodeByFirstCharacter=function(e,t,n){if(n===void 0){n=l.FORWARDS}var r=e.filter((function(e){return e.visible&&e.label[0].toLowerCase()==t.toLowerCase()}));var i=r.find((function(e){return e.selected}));var o=r.indexOf(i);var s=(o+(n==l.FORWARDS?1:-1)+r.length)%r.length;return r[s]};e.prototype.getNextSelectableNode=function(e,t){var n=e.filter((function(e){return e.visible}));var r=n.find((function(e){return e.selected}));var i=n.indexOf(r);if((t==l.BACKWARDS||t==l.FIRST)&&i==0){return false}if((t==l.FORWARDS||t==l.LAST)&&i==n.length-1){return false}var o=t==l.FORWARDS?i+1:t==l.BACKWARDS?i-1:t==l.LAST?n.length-1:0;return n[o]};e.prototype.onClick=function(e){var t=this.treeitems.find((function(t){return t.domElement==e.target}));if(!t)return;e.preventDefault();if(t.expandable){this.toggleTreeitem(t)}else{var n=this.treeitems.find((function(e){return e.id==t.parentId}));this.sntChange.emit({node:t,parentNode:n||null,originalEvent:e})}};e.prototype.toggleTreeitem=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n,r,i;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.updateExpandedTreeitems(this.treeitems,[e],t)];case 1:n=o.sent();e=n.find((function(t){return t.domElement==e.domElement}));r=n.filter((function(t){return t.parentId==e.id}));i=this;return[4,this.updateVisibleTreeitems(n,r)];case 2:i.treeitems=o.sent();return[2]}}))}))};e.prototype.onKeydown=function(e){if(this.keyboardEventProcessor.hasDelegatedHandler(e)||this.keyboardEventProcessor.hasDefaultHandler()){this.keyboardEventProcessor.process(e)}};e.prototype.onFocusin=function(e){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(n){switch(n.label){case 0:e=this.treeitems.find((function(e){return e.selected}));if(!!e)return[3,2];t=this;return[4,this.updateSelectedTreeitems(this.treeitems,[this.treeitems[0]])];case 1:t.treeitems=n.sent();n.label=2;case 2:return[2]}}))}))};e.prototype.getItemsFromTree=function(e,t,n){var r=this;var i=n;if(e.title){i=new c({label:e.title,key:e.key,url:e.url,id:t.length+1,languageId:e.languageId,parentId:n?n.id:null,expandable:e.items&&e.items.length>0,expanded:!!e.expanded,visible:!n||n.expanded});t.push(i)}if(e.items){e.items.forEach((function(e){r.getItemsFromTree(e,t,i)}))}return t};e.prototype.buildTreeview=function(e,t,n){var i=this;if(n===void 0){n=null}var o=e.filter((function(e){return e.parentId==n}));var s=o.reduce((function(n,o){var s=t?t+"-"+o.key:null;return __spreadArrays(n,[r("li",{role:o.expandable?"treeitem":"none",id:s,"aria-expanded":o.expanded?"true":"false","data-index":o.expandable?e.indexOf(c):null,tabindex:o.selected?"0":"-1",ref:function(e){o.domElement=e},class:{focused:o.selected}},o.expandable?[r("span",null,o.label),i.buildTreeview(e,s,o.id)]:[r("a",{role:"treeitem",id:s,href:"#"+s,class:{focused:o.selected},"data-index":e.indexOf(o),tabindex:o.selected?"0":"-1",ref:function(e){o.domElement=e}},o.label)])])}),[]);return r("ul",null,s)};e.prototype.render=function(){return r(i,{onClick:this.onClick.bind(this),onKeydown:this.onKeydown.bind(this),onFocusin:this.onFocusin.bind(this)},this.buildTreeview(this.treeitems,this.hostElement.id))};Object.defineProperty(e.prototype,"hostElement",{get:function(){return o(this)},enumerable:true,configurable:true});return e}());f.TAG_NAME="snt-treeview";f.style=d}}}));